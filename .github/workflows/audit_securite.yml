name: Audit SÃ©curitÃ© & QualitÃ©

# Quand est-ce que Ã§a se lance ? (Ã€ chaque "push" sur le code)
on: [push]

jobs:
  mon_job_audit:
    runs-on: ubuntu-latest  # Le robot utilise un Linux Ubuntu

    steps:
      # 1. Le robot rÃ©cupÃ¨re ton code
      - name: ğŸ“¥ RÃ©cupÃ©ration du code
        uses: actions/checkout@v4

      # 2. Le robot installe Python
      - name: ğŸ Installation Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # 3. Le robot installe les outils de vÃ©rification
      - name: ğŸ“¦ Installation des outils
        run: pip install pylint bandit

      # 4. LINTING : VÃ©rifie si le code est propre (Pylint)
      - name: ğŸ” VÃ©rification qualitÃ© (Lint)
        run: pylint **/*.py || true
        # "|| true" permet de continuer mÃªme s'il y a des petites fautes de style

      # 5. SÃ‰CURITÃ‰ : VÃ©rifie les failles (Bandit)
      - name: ğŸ›¡ï¸ Scan de sÃ©curitÃ©
        run: bandit -r . -ll
        # -r : scan tout le dossier, -ll : signale les problÃ¨mes moyens et graves

      # 6. EXÃ‰CUTION : Lance ton script en lui donnant la clÃ© du coffre
      - name: ğŸš€ Lancement du script
        env:
          # C'est ici qu'on connecte le secret GitHub Ã  la variable Python
          TARGET_IP: ${{ secrets.TARGET_IP }}
        run: python main.py
