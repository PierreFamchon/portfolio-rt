name: Audit QualitÃ© & SÃ©curitÃ© (Web)

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  analyse_code:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ RÃ©cupÃ©ration du code
        uses: actions/checkout@v4

      - name: ğŸ“¦ Installation Node.js (nÃ©cessaire pour les outils d'analyse)
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      # 1. VÃ©rification du HTML (Balises mal fermÃ©es, erreurs de syntaxe)
      - name: ğŸ” Audit HTML (HTMLHint)
        run: npx htmlhint "**/*.html" || true
        # "|| true" permet de ne pas bloquer le build si tu as juste une petite erreur

      # 2. VÃ©rification du JavaScript (Erreurs de logique)
      - name: ğŸ§  Audit JavaScript (ESLint)
        run: npx eslint "**/*.js" --no-error-on-unmatched-pattern || true

  scan_securite:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ RÃ©cupÃ©ration du code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # 3. VÃ©rifie si tu as laissÃ© des mots de passe/clÃ©s secrets dans le code
      - name: ğŸ•µï¸â€â™‚ï¸ Scan de secrets (Gitleaks)
        uses: gitleaks/gitleaks-action@v2
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          # Gitleaks va scanner tout ton historique pour voir si tu n'as pas commitÃ© un secret par erreur.
